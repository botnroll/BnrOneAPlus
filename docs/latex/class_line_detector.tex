\doxysection{Line\+Detector Class Reference}
\hypertarget{class_line_detector}{}\label{class_line_detector}\index{LineDetector@{LineDetector}}


{\ttfamily \#include $<$Line\+Detector.\+h$>$}

\doxysubsubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{class_line_detector_a39b34cdd80ad5d706b276bdf0b50c744}{Line\+Detector}} ()
\item 
int \mbox{\hyperlink{class_line_detector_a7f6ea080180b793ae9ac6ccedb7365dd}{Compute\+Line}} (int readings\mbox{[}8\mbox{]})
\begin{DoxyCompactList}\small\item\em Given an input as a set of sensors readings it computes a relative location of a line along the length of the sensor and expresses the output in a range \mbox{[}-\/100, 100\mbox{]} where 0 (zero) corresponds to the line being at the centre of the sensor. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_line_detector_aecedf6cd2b88c1da2d94595cab1ea22b}{Load\+Config}} ()
\begin{DoxyCompactList}\small\item\em Loads values from config and calculates the corresponding scaling factors. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_line_detector_acd690650f7c91bec033b43e8910c8119}{Set\+Config}} (const \mbox{\hyperlink{class_config}{Config}} \&config\+In)
\begin{DoxyCompactList}\small\item\em Set the config by providing it as input. \end{DoxyCompactList}\item 
int \texorpdfstring{$\ast$}{*} \mbox{\hyperlink{class_line_detector_affe740a6e3814d983094d42b0c689e88}{Normalise\+Readings}} (const int sensor\+Reading\mbox{[}8\mbox{]}) const
\begin{DoxyCompactList}\small\item\em Normalize values for each sensor reading. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Private Member Functions}
\begin{DoxyCompactItemize}
\item 
int \mbox{\hyperlink{class_line_detector_aa3fef0ae396112d2d2e567734cf8ab1a}{Normalise}} (const int reading, const int minimum, const float scale) const
\begin{DoxyCompactList}\small\item\em normalise a reading taking the minimum value of the range and a scale factor \end{DoxyCompactList}\item 
float \mbox{\hyperlink{class_line_detector_a174bc6de6d72526639c6d9d13a693cf6}{Calculate\+Factor}} (const int ref, const int min, const int max) const
\begin{DoxyCompactList}\small\item\em Calculates the scaling factor given a reference value and a range defined by min and max values This scaling factor is useful in normalising values. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_line_detector_ac367b704276b9a53d1812b2a5fbc93b4}{Calculate\+Scaling\+Factors}} ()
\begin{DoxyCompactList}\small\item\em Calculates and stores the scaling factors (in \+\_\+scaling\+Factors) \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_line_detector_ac576a77b66a3d994673c31ee856514c1}{Load\+If\+Necessary}} ()
\begin{DoxyCompactList}\small\item\em Loads values from config if NOT loaded before. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{class_line_detector_ad490812b0ab71af6e039081fff3a512b}{Get\+Max\+From\+Array}} (const int input\+Array\mbox{[}8\mbox{]}) const
\begin{DoxyCompactList}\small\item\em Get the Max From Array. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{class_line_detector_a8d530960d9251cd12fffc79b4bd2fa5d}{Compute\+Line\+Value}} (const int readings\mbox{[}8\mbox{]}) const
\begin{DoxyCompactList}\small\item\em Computes a line value in the range \mbox{[}0, ref\+\_\+max\mbox{]}. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{class_line_detector_a681c17fc737528ff65690683f92ead12}{Cap\+Value}} (const int value, const int lower\+Limit, const int upper\+Limit) const
\begin{DoxyCompactList}\small\item\em Caps the value to lower and upper limits. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{class_line_detector_a349923b55f7f56b7213b06fb9d728cdc}{Convert\+Range}} (const int x\+Value, const int x\+Min, const int x\+Max, const int y\+Min, const int y\+Max) const
\begin{DoxyCompactList}\small\item\em Converts a value x given in the range \mbox{[}x\+Min \+: x\+Max\mbox{]} to a new value in the range \mbox{[}y\+Min \+: y\+Max\mbox{]}. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{class_line_detector_afb948ea2f7042dfaaf50d7cb804f37d5}{Normalise\+Line\+Value}} (const int line\+Value, const int size) const
\begin{DoxyCompactList}\small\item\em Converts a line value in the range of \mbox{[}0, 8000\mbox{]} to a new range e.\+g. \mbox{[}-\/106, 106\mbox{]} This method involves two steps\+: 1) Converting the value in the range of \mbox{[}0, 8000\mbox{]} to a new range using a correction factor e.\+g. for a correction factor of 6\% the new range is \mbox{[}-\/106, 106\mbox{]} The new range extends beyond 100 by a little margin specified by the correction factor in the config. The purpose of this is to enable adjusting the sensitivity of the readings near the extremities. For a sensor that is typically higher (away from the floor) this correction factor should be higher to prevent large jumps in the readings close to the extremities. By increasing the correction factor we are narrowing the sensitivity of the sensors and by reducing it we are extending the sensitivity out. There is a balance to achieve by tuning this value correctly in order to get the best of both worlds\+: \end{DoxyCompactList}\item 
int \mbox{\hyperlink{class_line_detector_a8afa1971a787fd196678c0705defee72}{Filter\+Line\+Value}} (const int line\+Value\+\_\+in, const int ref\+Value, const int max\+Value)
\begin{DoxyCompactList}\small\item\em Filters the line value to handle edge cases such as no line detected or reading errors. \end{DoxyCompactList}\item 
long int \mbox{\hyperlink{class_line_detector_a016d14edf3b8a513c6e3b976ba2f54da}{Sum}} (const long int reading\mbox{[}8\mbox{]}) const
\begin{DoxyCompactList}\small\item\em Computes the sum of all the values in the input array. \end{DoxyCompactList}\item 
long \texorpdfstring{$\ast$}{*} \mbox{\hyperlink{class_line_detector_acf6cba40a9b902d7eff9d06ad92cd521}{Cast\+To\+Long\+Int}} (const int int\+Array\mbox{[}8\mbox{]}) const
\begin{DoxyCompactList}\small\item\em Casts an array of integers to an array of long integers. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{class_line_detector_ad42faa73d686759d71bc2d3a4728332b}{Compute\+Mean\+Gaussian}} (const int reading\mbox{[}8\mbox{]}) const
\begin{DoxyCompactList}\small\item\em Lets assume the line detected gives us a discrete gaussian where the probabilities are given by each sensor reading and the values are pre-\/determined based on each sensor location\+: \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_line_detector_a98a577704509458bf101b62d030744c1}{Get\+Max\+Value\+And\+Index}} (const int array\mbox{[}8\mbox{]}, int \&max\+Value, int \&max\+Value\+Index) const
\begin{DoxyCompactList}\small\item\em Returns the max value and its corresponding index from a list. \end{DoxyCompactList}\item 
int \texorpdfstring{$\ast$}{*} \mbox{\hyperlink{class_line_detector_a8853928eb3eb21b1a88fee7b88f0f53f}{Prune}} (int readings\mbox{[}8\mbox{]}) const
\begin{DoxyCompactList}\small\item\em Deals with edge cases such when the max readings is on one of the sensors at the extremety. In such cases it bumps up the value of the sensor to be at the threshold level. \end{DoxyCompactList}\item 
\mbox{\hyperlink{class_config}{Config}} \mbox{\hyperlink{class_line_detector_a7fd1a0899f255d783c69797450374b7c}{Get\+Config}} () const
\begin{DoxyCompactList}\small\item\em Get the \doxylink{class_config}{Config} object. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Private Attributes}
\begin{DoxyCompactItemize}
\item 
bool \mbox{\hyperlink{class_line_detector_a8646ffe114063760e7d33c46f2119f6b}{\+\_\+cfg\+Loaded}} = false
\item 
int \mbox{\hyperlink{class_line_detector_a1d4f4b6a173ebd82445948ddd02438fe}{\+\_\+previous\+Line\+Value}} = 0
\item 
\mbox{\hyperlink{class_config}{Config}} \mbox{\hyperlink{class_line_detector_a06b26d7ac645121a68ff3fa3c1171fc9}{\+\_\+config}} = \mbox{\hyperlink{class_config}{Config}}()
\item 
float \mbox{\hyperlink{class_line_detector_ac2f37aef4a74858c240fe691b8ce9c7c}{\+\_\+scaling\+Factor}} \mbox{[}8\mbox{]}
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Line detector class

It assumes that the array of sensors of a sensor peripheral are arranged in a straight line and equally spaced. Converts line sensor readings into a relative line position on the sensor. It provides methods to compute the location of the line relative to the device. It outputs values in a range \mbox{[}-\/100, 100\mbox{]} where 0 (zero) corresponds to the centre of the sensor peripheral. 

\doxysubsection{Constructor \& Destructor Documentation}
\Hypertarget{class_line_detector_a39b34cdd80ad5d706b276bdf0b50c744}\index{LineDetector@{LineDetector}!LineDetector@{LineDetector}}
\index{LineDetector@{LineDetector}!LineDetector@{LineDetector}}
\doxysubsubsection{\texorpdfstring{LineDetector()}{LineDetector()}}
{\footnotesize\ttfamily \label{class_line_detector_a39b34cdd80ad5d706b276bdf0b50c744} 
Line\+Detector\+::\+Line\+Detector (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption})}



\doxysubsection{Member Function Documentation}
\Hypertarget{class_line_detector_a174bc6de6d72526639c6d9d13a693cf6}\index{LineDetector@{LineDetector}!CalculateFactor@{CalculateFactor}}
\index{CalculateFactor@{CalculateFactor}!LineDetector@{LineDetector}}
\doxysubsubsection{\texorpdfstring{CalculateFactor()}{CalculateFactor()}}
{\footnotesize\ttfamily \label{class_line_detector_a174bc6de6d72526639c6d9d13a693cf6} 
float Line\+Detector\+::\+Calculate\+Factor (\begin{DoxyParamCaption}\item[{const int}]{ref}{, }\item[{const int}]{min}{, }\item[{const int}]{max}{}\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [private]}}



Calculates the scaling factor given a reference value and a range defined by min and max values This scaling factor is useful in normalising values. 

\begin{DoxyReturn}{Returns}
float scaling factor 
\end{DoxyReturn}
\Hypertarget{class_line_detector_ac367b704276b9a53d1812b2a5fbc93b4}\index{LineDetector@{LineDetector}!CalculateScalingFactors@{CalculateScalingFactors}}
\index{CalculateScalingFactors@{CalculateScalingFactors}!LineDetector@{LineDetector}}
\doxysubsubsection{\texorpdfstring{CalculateScalingFactors()}{CalculateScalingFactors()}}
{\footnotesize\ttfamily \label{class_line_detector_ac367b704276b9a53d1812b2a5fbc93b4} 
void Line\+Detector\+::\+Calculate\+Scaling\+Factors (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Calculates and stores the scaling factors (in \+\_\+scaling\+Factors) 

\Hypertarget{class_line_detector_a681c17fc737528ff65690683f92ead12}\index{LineDetector@{LineDetector}!CapValue@{CapValue}}
\index{CapValue@{CapValue}!LineDetector@{LineDetector}}
\doxysubsubsection{\texorpdfstring{CapValue()}{CapValue()}}
{\footnotesize\ttfamily \label{class_line_detector_a681c17fc737528ff65690683f92ead12} 
int Line\+Detector\+::\+Cap\+Value (\begin{DoxyParamCaption}\item[{const int}]{value}{, }\item[{const int}]{lower\+Limit}{, }\item[{const int}]{upper\+Limit}{}\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [private]}}



Caps the value to lower and upper limits. 

\begin{DoxyReturn}{Returns}
capped value 
\end{DoxyReturn}
\Hypertarget{class_line_detector_acf6cba40a9b902d7eff9d06ad92cd521}\index{LineDetector@{LineDetector}!CastToLongInt@{CastToLongInt}}
\index{CastToLongInt@{CastToLongInt}!LineDetector@{LineDetector}}
\doxysubsubsection{\texorpdfstring{CastToLongInt()}{CastToLongInt()}}
{\footnotesize\ttfamily \label{class_line_detector_acf6cba40a9b902d7eff9d06ad92cd521} 
long \texorpdfstring{$\ast$}{*} Line\+Detector\+::\+Cast\+To\+Long\+Int (\begin{DoxyParamCaption}\item[{const int}]{int\+Array}{\mbox{[}8\mbox{]}}\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [private]}}



Casts an array of integers to an array of long integers. 


\begin{DoxyParams}{Parameters}
{\em int\+Array} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
long\texorpdfstring{$\ast$}{*} 
\end{DoxyReturn}
\Hypertarget{class_line_detector_a7f6ea080180b793ae9ac6ccedb7365dd}\index{LineDetector@{LineDetector}!ComputeLine@{ComputeLine}}
\index{ComputeLine@{ComputeLine}!LineDetector@{LineDetector}}
\doxysubsubsection{\texorpdfstring{ComputeLine()}{ComputeLine()}}
{\footnotesize\ttfamily \label{class_line_detector_a7f6ea080180b793ae9ac6ccedb7365dd} 
int Line\+Detector\+::\+Compute\+Line (\begin{DoxyParamCaption}\item[{int}]{readings}{\mbox{[}8\mbox{]}}\end{DoxyParamCaption})}



Given an input as a set of sensors readings it computes a relative location of a line along the length of the sensor and expresses the output in a range \mbox{[}-\/100, 100\mbox{]} where 0 (zero) corresponds to the line being at the centre of the sensor. 


\begin{DoxyParams}{Parameters}
{\em readings} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
int 
\end{DoxyReturn}
\Hypertarget{class_line_detector_a8d530960d9251cd12fffc79b4bd2fa5d}\index{LineDetector@{LineDetector}!ComputeLineValue@{ComputeLineValue}}
\index{ComputeLineValue@{ComputeLineValue}!LineDetector@{LineDetector}}
\doxysubsubsection{\texorpdfstring{ComputeLineValue()}{ComputeLineValue()}}
{\footnotesize\ttfamily \label{class_line_detector_a8d530960d9251cd12fffc79b4bd2fa5d} 
int Line\+Detector\+::\+Compute\+Line\+Value (\begin{DoxyParamCaption}\item[{const int}]{readings}{\mbox{[}8\mbox{]}}\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [private]}}



Computes a line value in the range \mbox{[}0, ref\+\_\+max\mbox{]}. 


\begin{DoxyParams}{Parameters}
{\em readings} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
int 
\end{DoxyReturn}
\Hypertarget{class_line_detector_ad42faa73d686759d71bc2d3a4728332b}\index{LineDetector@{LineDetector}!ComputeMeanGaussian@{ComputeMeanGaussian}}
\index{ComputeMeanGaussian@{ComputeMeanGaussian}!LineDetector@{LineDetector}}
\doxysubsubsection{\texorpdfstring{ComputeMeanGaussian()}{ComputeMeanGaussian()}}
{\footnotesize\ttfamily \label{class_line_detector_ad42faa73d686759d71bc2d3a4728332b} 
int Line\+Detector\+::\+Compute\+Mean\+Gaussian (\begin{DoxyParamCaption}\item[{const int}]{reading}{\mbox{[}8\mbox{]}}\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [private]}}



Lets assume the line detected gives us a discrete gaussian where the probabilities are given by each sensor reading and the values are pre-\/determined based on each sensor location\+: 

\tabulinesep=1mm
\begin{longtabu}spread 0pt [c]{*{3}{|X[-1]}|}
\hline
\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ sensor id   }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ value   }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ probability    }\\\cline{1-3}
\endfirsthead
\hline
\endfoot
\hline
\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ sensor id   }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ value   }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ probability    }\\\cline{1-3}
\endhead
0   &1   &reading\mbox{[}0\mbox{]}    \\\cline{1-3}
1   &2   &reading\mbox{[}1\mbox{]}    \\\cline{1-3}
(...)   &(...)   &(...)    \\\cline{1-3}
7   &8   &reading\mbox{[}7\mbox{]}   \\\cline{1-3}
\end{longtabu}
We can compute the mean of the gaussian (location of line) by\+: 1) computing the product for each sensor\+: product = value \texorpdfstring{$\ast$}{*} probability 2) computing sum\+Products = product\mbox{[}0\mbox{]} + product\mbox{[}1\mbox{]} + ... + product\mbox{[}7\mbox{]} 3) computing sum\+\_\+probabilities = reading\mbox{[}0\mbox{]} + reading\mbox{[}1\mbox{]} + ... + reading\mbox{[}7\mbox{]} 4) computing mean = sum\+Products / sum\+\_\+probabilities


\begin{DoxyParams}{Parameters}
{\em readings} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
int 
\end{DoxyReturn}
\Hypertarget{class_line_detector_a349923b55f7f56b7213b06fb9d728cdc}\index{LineDetector@{LineDetector}!ConvertRange@{ConvertRange}}
\index{ConvertRange@{ConvertRange}!LineDetector@{LineDetector}}
\doxysubsubsection{\texorpdfstring{ConvertRange()}{ConvertRange()}}
{\footnotesize\ttfamily \label{class_line_detector_a349923b55f7f56b7213b06fb9d728cdc} 
int Line\+Detector\+::\+Convert\+Range (\begin{DoxyParamCaption}\item[{const int}]{x\+Value}{, }\item[{const int}]{x\+Min}{, }\item[{const int}]{x\+Max}{, }\item[{const int}]{y\+Min}{, }\item[{const int}]{y\+Max}{}\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [private]}}



Converts a value x given in the range \mbox{[}x\+Min \+: x\+Max\mbox{]} to a new value in the range \mbox{[}y\+Min \+: y\+Max\mbox{]}. 

\begin{DoxyReturn}{Returns}
value converted to the new range 
\end{DoxyReturn}
\Hypertarget{class_line_detector_a8afa1971a787fd196678c0705defee72}\index{LineDetector@{LineDetector}!FilterLineValue@{FilterLineValue}}
\index{FilterLineValue@{FilterLineValue}!LineDetector@{LineDetector}}
\doxysubsubsection{\texorpdfstring{FilterLineValue()}{FilterLineValue()}}
{\footnotesize\ttfamily \label{class_line_detector_a8afa1971a787fd196678c0705defee72} 
int Line\+Detector\+::\+Filter\+Line\+Value (\begin{DoxyParamCaption}\item[{const int}]{line\+Value\+\_\+in}{, }\item[{const int}]{ref\+Value}{, }\item[{const int}]{max\+Value}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Filters the line value to handle edge cases such as no line detected or reading errors. 


\begin{DoxyParams}{Parameters}
{\em line\+Value} & the computed line value \\
\hline
{\em ref\+Value} & the reference value to help determining which side is the line in case it\textquotesingle{}s no longer detected (e.\+g. middle of the range) \\
\hline
{\em max\+Value} & the maximum value of the range \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
int 
\end{DoxyReturn}
\Hypertarget{class_line_detector_a7fd1a0899f255d783c69797450374b7c}\index{LineDetector@{LineDetector}!GetConfig@{GetConfig}}
\index{GetConfig@{GetConfig}!LineDetector@{LineDetector}}
\doxysubsubsection{\texorpdfstring{GetConfig()}{GetConfig()}}
{\footnotesize\ttfamily \label{class_line_detector_a7fd1a0899f255d783c69797450374b7c} 
\mbox{\hyperlink{class_config}{Config}} Line\+Detector\+::\+Get\+Config (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [private]}}



Get the \doxylink{class_config}{Config} object. 

\Hypertarget{class_line_detector_ad490812b0ab71af6e039081fff3a512b}\index{LineDetector@{LineDetector}!GetMaxFromArray@{GetMaxFromArray}}
\index{GetMaxFromArray@{GetMaxFromArray}!LineDetector@{LineDetector}}
\doxysubsubsection{\texorpdfstring{GetMaxFromArray()}{GetMaxFromArray()}}
{\footnotesize\ttfamily \label{class_line_detector_ad490812b0ab71af6e039081fff3a512b} 
int Line\+Detector\+::\+Get\+Max\+From\+Array (\begin{DoxyParamCaption}\item[{const int}]{input\+Array}{\mbox{[}8\mbox{]}}\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [private]}}



Get the Max From Array. 


\begin{DoxyParams}{Parameters}
{\em input\+Array} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
int 
\end{DoxyReturn}
\Hypertarget{class_line_detector_a98a577704509458bf101b62d030744c1}\index{LineDetector@{LineDetector}!GetMaxValueAndIndex@{GetMaxValueAndIndex}}
\index{GetMaxValueAndIndex@{GetMaxValueAndIndex}!LineDetector@{LineDetector}}
\doxysubsubsection{\texorpdfstring{GetMaxValueAndIndex()}{GetMaxValueAndIndex()}}
{\footnotesize\ttfamily \label{class_line_detector_a98a577704509458bf101b62d030744c1} 
void Line\+Detector\+::\+Get\+Max\+Value\+And\+Index (\begin{DoxyParamCaption}\item[{const int}]{array}{\mbox{[}8\mbox{]}, }\item[{int \&}]{max\+Value}{, }\item[{int \&}]{max\+Value\+Index}{}\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [private]}}



Returns the max value and its corresponding index from a list. 

\begin{DoxyReturn}{Returns}
def 
\end{DoxyReturn}
\Hypertarget{class_line_detector_aecedf6cd2b88c1da2d94595cab1ea22b}\index{LineDetector@{LineDetector}!LoadConfig@{LoadConfig}}
\index{LoadConfig@{LoadConfig}!LineDetector@{LineDetector}}
\doxysubsubsection{\texorpdfstring{LoadConfig()}{LoadConfig()}}
{\footnotesize\ttfamily \label{class_line_detector_aecedf6cd2b88c1da2d94595cab1ea22b} 
void Line\+Detector\+::\+Load\+Config (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption})}



Loads values from config and calculates the corresponding scaling factors. 

\Hypertarget{class_line_detector_ac576a77b66a3d994673c31ee856514c1}\index{LineDetector@{LineDetector}!LoadIfNecessary@{LoadIfNecessary}}
\index{LoadIfNecessary@{LoadIfNecessary}!LineDetector@{LineDetector}}
\doxysubsubsection{\texorpdfstring{LoadIfNecessary()}{LoadIfNecessary()}}
{\footnotesize\ttfamily \label{class_line_detector_ac576a77b66a3d994673c31ee856514c1} 
void Line\+Detector\+::\+Load\+If\+Necessary (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Loads values from config if NOT loaded before. 

\Hypertarget{class_line_detector_aa3fef0ae396112d2d2e567734cf8ab1a}\index{LineDetector@{LineDetector}!Normalise@{Normalise}}
\index{Normalise@{Normalise}!LineDetector@{LineDetector}}
\doxysubsubsection{\texorpdfstring{Normalise()}{Normalise()}}
{\footnotesize\ttfamily \label{class_line_detector_aa3fef0ae396112d2d2e567734cf8ab1a} 
int Line\+Detector\+::\+Normalise (\begin{DoxyParamCaption}\item[{const int}]{reading}{, }\item[{const int}]{minimum}{, }\item[{const float}]{scale}{}\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [private]}}



normalise a reading taking the minimum value of the range and a scale factor 


\begin{DoxyParams}{Parameters}
{\em reading} & a sensor readings \\
\hline
{\em minimum} & the minimum value of sensor reading \\
\hline
{\em scale} & scaling factor \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
normalised value 
\end{DoxyReturn}
\Hypertarget{class_line_detector_afb948ea2f7042dfaaf50d7cb804f37d5}\index{LineDetector@{LineDetector}!NormaliseLineValue@{NormaliseLineValue}}
\index{NormaliseLineValue@{NormaliseLineValue}!LineDetector@{LineDetector}}
\doxysubsubsection{\texorpdfstring{NormaliseLineValue()}{NormaliseLineValue()}}
{\footnotesize\ttfamily \label{class_line_detector_afb948ea2f7042dfaaf50d7cb804f37d5} 
int Line\+Detector\+::\+Normalise\+Line\+Value (\begin{DoxyParamCaption}\item[{const int}]{line\+Value}{, }\item[{const int}]{size}{}\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [private]}}



Converts a line value in the range of \mbox{[}0, 8000\mbox{]} to a new range e.\+g. \mbox{[}-\/106, 106\mbox{]} This method involves two steps\+: 1) Converting the value in the range of \mbox{[}0, 8000\mbox{]} to a new range using a correction factor e.\+g. for a correction factor of 6\% the new range is \mbox{[}-\/106, 106\mbox{]} The new range extends beyond 100 by a little margin specified by the correction factor in the config. The purpose of this is to enable adjusting the sensitivity of the readings near the extremities. For a sensor that is typically higher (away from the floor) this correction factor should be higher to prevent large jumps in the readings close to the extremities. By increasing the correction factor we are narrowing the sensitivity of the sensors and by reducing it we are extending the sensitivity out. There is a balance to achieve by tuning this value correctly in order to get the best of both worlds\+: 


\begin{DoxyItemize}
\item Smooth transitions in sensor value near the extremeties
\item Maximum sensitivity region of the sensor 2) Capping the values to the desired range \mbox{[}-\/100, 100\mbox{]}
\end{DoxyItemize}


\begin{DoxyParams}{Parameters}
{\em line\+Value} & input line value \\
\hline
{\em size} & size of sensor readings \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
int normalised line value 
\end{DoxyReturn}
\Hypertarget{class_line_detector_affe740a6e3814d983094d42b0c689e88}\index{LineDetector@{LineDetector}!NormaliseReadings@{NormaliseReadings}}
\index{NormaliseReadings@{NormaliseReadings}!LineDetector@{LineDetector}}
\doxysubsubsection{\texorpdfstring{NormaliseReadings()}{NormaliseReadings()}}
{\footnotesize\ttfamily \label{class_line_detector_affe740a6e3814d983094d42b0c689e88} 
int \texorpdfstring{$\ast$}{*} Line\+Detector\+::\+Normalise\+Readings (\begin{DoxyParamCaption}\item[{const int}]{sensor\+Reading}{\mbox{[}8\mbox{]}}\end{DoxyParamCaption}) const}



Normalize values for each sensor reading. 


\begin{DoxyParams}{Parameters}
{\em sensor\+\_\+reading} & array containing sensor readings \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
array 
\end{DoxyReturn}
\Hypertarget{class_line_detector_a8853928eb3eb21b1a88fee7b88f0f53f}\index{LineDetector@{LineDetector}!Prune@{Prune}}
\index{Prune@{Prune}!LineDetector@{LineDetector}}
\doxysubsubsection{\texorpdfstring{Prune()}{Prune()}}
{\footnotesize\ttfamily \label{class_line_detector_a8853928eb3eb21b1a88fee7b88f0f53f} 
int \texorpdfstring{$\ast$}{*} Line\+Detector\+::\+Prune (\begin{DoxyParamCaption}\item[{int}]{readings}{\mbox{[}8\mbox{]}}\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [private]}}



Deals with edge cases such when the max readings is on one of the sensors at the extremety. In such cases it bumps up the value of the sensor to be at the threshold level. 


\begin{DoxyParams}{Parameters}
{\em readings} & \\
\hline
\end{DoxyParams}
\Hypertarget{class_line_detector_acd690650f7c91bec033b43e8910c8119}\index{LineDetector@{LineDetector}!SetConfig@{SetConfig}}
\index{SetConfig@{SetConfig}!LineDetector@{LineDetector}}
\doxysubsubsection{\texorpdfstring{SetConfig()}{SetConfig()}}
{\footnotesize\ttfamily \label{class_line_detector_acd690650f7c91bec033b43e8910c8119} 
void Line\+Detector\+::\+Set\+Config (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_config}{Config}} \&}]{config\+In}{}\end{DoxyParamCaption})}



Set the config by providing it as input. 


\begin{DoxyParams}{Parameters}
{\em config\+In} & \\
\hline
\end{DoxyParams}
\Hypertarget{class_line_detector_a016d14edf3b8a513c6e3b976ba2f54da}\index{LineDetector@{LineDetector}!Sum@{Sum}}
\index{Sum@{Sum}!LineDetector@{LineDetector}}
\doxysubsubsection{\texorpdfstring{Sum()}{Sum()}}
{\footnotesize\ttfamily \label{class_line_detector_a016d14edf3b8a513c6e3b976ba2f54da} 
long int Line\+Detector\+::\+Sum (\begin{DoxyParamCaption}\item[{const long int}]{reading}{\mbox{[}8\mbox{]}}\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [private]}}



Computes the sum of all the values in the input array. 


\begin{DoxyParams}{Parameters}
{\em reading} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
long int 
\end{DoxyReturn}


\doxysubsection{Member Data Documentation}
\Hypertarget{class_line_detector_a8646ffe114063760e7d33c46f2119f6b}\index{LineDetector@{LineDetector}!\_cfgLoaded@{\_cfgLoaded}}
\index{\_cfgLoaded@{\_cfgLoaded}!LineDetector@{LineDetector}}
\doxysubsubsection{\texorpdfstring{\_cfgLoaded}{\_cfgLoaded}}
{\footnotesize\ttfamily \label{class_line_detector_a8646ffe114063760e7d33c46f2119f6b} 
bool Line\+Detector\+::\+\_\+cfg\+Loaded = false\hspace{0.3cm}{\ttfamily [private]}}

\Hypertarget{class_line_detector_a06b26d7ac645121a68ff3fa3c1171fc9}\index{LineDetector@{LineDetector}!\_config@{\_config}}
\index{\_config@{\_config}!LineDetector@{LineDetector}}
\doxysubsubsection{\texorpdfstring{\_config}{\_config}}
{\footnotesize\ttfamily \label{class_line_detector_a06b26d7ac645121a68ff3fa3c1171fc9} 
\mbox{\hyperlink{class_config}{Config}} Line\+Detector\+::\+\_\+config = \mbox{\hyperlink{class_config}{Config}}()\hspace{0.3cm}{\ttfamily [private]}}

\Hypertarget{class_line_detector_a1d4f4b6a173ebd82445948ddd02438fe}\index{LineDetector@{LineDetector}!\_previousLineValue@{\_previousLineValue}}
\index{\_previousLineValue@{\_previousLineValue}!LineDetector@{LineDetector}}
\doxysubsubsection{\texorpdfstring{\_previousLineValue}{\_previousLineValue}}
{\footnotesize\ttfamily \label{class_line_detector_a1d4f4b6a173ebd82445948ddd02438fe} 
int Line\+Detector\+::\+\_\+previous\+Line\+Value = 0\hspace{0.3cm}{\ttfamily [private]}}

\Hypertarget{class_line_detector_ac2f37aef4a74858c240fe691b8ce9c7c}\index{LineDetector@{LineDetector}!\_scalingFactor@{\_scalingFactor}}
\index{\_scalingFactor@{\_scalingFactor}!LineDetector@{LineDetector}}
\doxysubsubsection{\texorpdfstring{\_scalingFactor}{\_scalingFactor}}
{\footnotesize\ttfamily \label{class_line_detector_ac2f37aef4a74858c240fe691b8ce9c7c} 
float Line\+Detector\+::\+\_\+scaling\+Factor\mbox{[}8\mbox{]}\hspace{0.3cm}{\ttfamily [private]}}



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
src/utility/\mbox{\hyperlink{_line_detector_8h}{Line\+Detector.\+h}}\item 
src/utility/\mbox{\hyperlink{_line_detector_8cpp}{Line\+Detector.\+cpp}}\end{DoxyCompactItemize}
